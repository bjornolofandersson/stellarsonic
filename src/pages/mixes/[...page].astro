---
import { getCollection } from 'astro:content';
import Page from '@theme/layouts/Page.astro'
import { uniqueGenres } from '@lib/utils';
import SiteHero from '@theme/components/SiteHero.astro';
import Paginator from '@theme/components/Paginator.astro';
import MusicPlaylistPreview from '@theme/components/playlist/Preview.astro';
import * as site from '@settings';
import Mixes from '@theme/layouts/Mixes.astro';
import MixListEditor from '@components/editor/MixListEditor.svelte';


export async function getStaticPaths({ paginate }: any) {
  const posts = await getCollection('mixes');
  const sortedPosts = posts.sort((a, b) => {
    //return b.data.date.localeCompare(a.data.date);
    return 1;
  });

  return paginate(sortedPosts, { pageSize: site.blog.pageSize });
}

const isDev = import.meta.env.MODE === 'development';
const { page } = Astro.props;
const genres = await getCollection('mixes').then(posts => {
  return uniqueGenres(posts.map(({ data }) => data) as any);
});
---

<Page>
  {isDev ?
    <MixListEditor>
      <Mixes page={page} genres={genres} />
    </MixListEditor>
  :
    <Mixes page={page} genres={genres} />
  }
</Page>
