---
import BlogTheme from './blog.svelte';
import { Page as AstroPage } from 'astro';
import { BlogPage } from './blog';
import theme from '@theme/index';
import { PageProps } from '@lib/interfaces';

interface Props extends PageProps<any> {
  pagination: AstroPage;
}

const { entity, page, pagination, site } = Astro.props;
const isDev = import.meta.env.MODE === 'development';


const blogPage: BlogPage = {
  title: entity.data.title,
  url: `/${page.slug}`,
  posts: pagination.data.map(({slug, data, collection}) => ({
    slug, url: `/${page.slug}/${slug}`, data, collection
  })),
  theme: {},
  currentPage: pagination.currentPage,
  start: pagination.start,
  end: pagination.end,
  total: pagination.total,
  size: pagination.size,
  lastPage: pagination.lastPage,
}

const themeSettings = theme.modules.blog;
---

{isDev || themeSettings.client
  ? <BlogTheme page={blogPage} entity={entity} site={site} client:load />
  : <BlogTheme page={blogPage} entity={entity} site={site} />
}
